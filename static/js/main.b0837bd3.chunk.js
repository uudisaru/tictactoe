(this.webpackJsonptictactoe=this.webpackJsonptictactoe||[]).push([[0],{30:function(e,t,a){e.exports=a(61)},35:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),i=a.n(c),s=(a(35),a(2)),u=a.n(s),o=a(10),l=a(5),m=a(6),f=(a(37),a(38),a(63)),d=Object.freeze({Server:"server",Minimax:"minimax algorithm"}),p=Object.freeze({Uninitialized:"uninitialized",InProgress:"in-progress",Lose:"lose",Tie:"tie",Win:"win",isFinished:function(e){return e===p.Lose||e===p.Win}}),v=Object.freeze({Circle:1,Cross:-1,Empty:0}),b=Object.freeze({Ai:v.Cross,Player:v.Circle}),h=Object.freeze({Row:"row",Column:"col",Diagonal:"diag"}),w={board:Object(f.c)(3,3).toArray(),result:null,status:p.Uninitialized,turn:b.Player},g=function(e){var t=e.onClick,a=e.value;return r.a.createElement("div",{className:"cell"},a===v.Circle?r.a.createElement("div",{className:"cell__circle"}):a===v.Cross?r.a.createElement("div",{className:"cell__cross"}):r.a.createElement("button",{className:"cell__empty",onClick:t}))},y=(a(40),function(e){return r.a.createElement("div",{className:"loader",style:{fontSize:e.size}},r.a.createElement("div",{className:"loader__center"},r.a.createElement("i",{className:"fa fa-cog fa-spin"})))}),E=(a(41),function(e){return r.a.createElement("div",{className:"overlay"},r.a.createElement("div",{className:"overlay__center"},r.a.createElement("span",{style:{fontSize:e.size}},e.text)))});var k=function(e){var t=void 0;return e.interaction.loading&&(t=r.a.createElement(y,{size:90})),e.interaction.waiting&&(t=r.a.createElement(E,{size:24,text:"Start a game"})),r.a.createElement("main",{className:"tictactoe"},e.board.map((function(t,a){return r.a.createElement("div",{className:"tictactoe__row",key:a},t.map((function(t,n){return r.a.createElement(g,{key:n,onClick:e.result?void 0:function(){return e.move(a,n)},value:t})})))})),e.result&&function(e){var t={};switch(e.type){case"row":t.top=48+102*e.index;break;case"col":t.left=48+102*e.index;break;default:t.transform=0===e.index?"rotate(45deg)":"rotate(-45deg)"}return r.a.createElement("div",{className:"strike-through strike-through-"+e.type,style:t})}(e.result),t)},O=(a(42),function(e){var t=Object(n.useState)(!0),a=Object(m.a)(t,2),c=a[0],i=a[1];return r.a.createElement("header",{className:"controls"},r.a.createElement("div",{className:"controls__status"},r.a.createElement("label",null,"Status:"),r.a.createElement("span",null,e.status)),e.status!==p.InProgress&&r.a.createElement("div",{className:"controls__game"},r.a.createElement("div",{className:"game__start"},r.a.createElement("input",{id:"game-start",type:"checkbox",checked:c,onChange:function(){return i(!c)}}),r.a.createElement("label",{htmlFor:"game-start"},"Start with my move")),r.a.createElement("div",{className:"game__play"},r.a.createElement("button",{onClick:function(){return e.play(c)}},e.status===p.Uninitialized?"Play":"Play again"))))}),j=a(15),x=a(16),_=a.n(x),N=a(12),C=a(29);function P(e,t){var a,n={status:p.Tie},r=Object(C.a)(e.entries());try{for(r.s();!(a=r.n()).done;){var c=Object(m.a)(a.value,2),i=c[0],s=c[1],u=new Set(s);if(u.has(v.Empty))n.status=p.InProgress;else if(1===u.size){var o=u.values().next().value,l={index:i,type:t};return l.status=o===v.Circle?p.Win:p.Lose,l}}}catch(f){r.e(f)}finally{r.f()}return n}function S(e){var t=P(e,h.Row);if(p.isFinished(t.status))return t;var a=P(Object(f.b)(e),h.Column);return p.isFinished(a.status)?a:(a=P([Object(f.a)(e),[e[0][2],e[1][1],e[2][0]]],h.Diagonal),p.isFinished(a.status)?a:t)}function z(e){return e.map((function(e){return Object(N.a)(e)}))}function A(e,t,a,n){var r=Object(N.a)(e);return r[t]=Object(N.a)(r[t]),r[t].splice(a,1,n),{newBoard:r}}function B(e,t,a,n,r){var c=[-1,-1],i=t===b.Ai?-1e3:1e3,s=S(e).status;if(s!==p.InProgress)return[i=function(e){return e===p.Lose?1e3:e!==p.InProgress?-1e3:0}(s),c];var u=function(e){var t=[];return e.forEach((function(e,a){e.forEach((function(e,n){e===v.Empty&&t.push([a,n])}))})),t}(e);if(0===a&&1===u.length)return[0,u[0]];for(var o=0;o<u.length;o++){var l=Object(m.a)(u[o],2),f=l[0],d=l[1];e[f][d]=t;var h=B(e,t===b.Ai?b.Player:b.Ai,a+1,n,r)[0];if(t===b.Ai){if(i<h&&(i=h-10*a,c=[f,d],n=Math.max(n,i),e[f][d]=0,r<=n))break}else if(i>h&&(i=h+10*a,c=[f,d],r=Math.min(r,i),e[f][d]=0,r<=n))break;e[f][d]=0}return[i,c]}var I=null;function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(u.a.mark((function e(t,a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t?n=Object(o.a)({},w):((n={board:Object(f.c)(3,3).toArray(),turn:b.Player}).board[1][1]=b.Ai,n.id=a),n.status=p.InProgress,n.id=1,I=n.board,e.abrupt("return",Promise.resolve(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,a){return T.apply(this,arguments)}function T(){return(T=Object(l.a)(u.a.mark((function e(t,a,n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I=A(I,a,n,b.Player).newBoard,(r=S(I)).status===p.InProgress&&(c=B(z(I),b.Ai,0,-1e3,1e3),I=A(I,c[1][0],c[1][1],b.Ai).newBoard,r=S(I)),e.abrupt("return",Promise.resolve({board:I,id:t,status:r.status,turn:b.Player}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W="https://tictac.aktors.ee/api/board",R={headers:{"Access-Control-Allow-Origin":window.origin}};function U(e){return D.apply(this,arguments)}function D(){return(D=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.post(W+"?turn="+(t?"mine":"yours"),R);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,a){return $.apply(this,arguments)}function $(){return($=Object(l.a)(u.a.mark((function e(t,a,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.put(W+"/".concat(t,"?x=").concat(a,"&y=").concat(n),R);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function e(){var t=this;Object(j.a)(this,e),this.createBoard=function(){var e=Object(l.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,t.id+=1,e.abrupt("return",L(a,n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.takeTurn=function(){var e=Object(l.a)(u.a.mark((function e(t,a,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F(t,a,n));case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},G=function e(){Object(j.a)(this,e),this.createBoard=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.takeTurn=function(){var e=Object(l.a)(u.a.mark((function e(t,a,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t,a,n));case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()};a(60);var H=function(e){var t=e.label,a=e.checked,n=e.onChange,c=t.replace(" ","-");return r.a.createElement("div",{className:"switch"},r.a.createElement("div",{className:"switch__container"},r.a.createElement("input",{id:c,checked:a,onChange:n,className:"switch__input",type:"checkbox"}),r.a.createElement("label",{htmlFor:c,className:"switch__label"})),r.a.createElement("div",{className:"switch__content"},t))};function K(e,t,a){return function(n){var r=n.target,c="checkbox"===r.type?r.checked:r.value;a(c?e:t)}}var Q=function(e){var t=e.backend,a=e.selectBackend,c=Object(n.useRef)(),i=Object(n.useState)(!1),s=Object(m.a)(i,2),u=s[0],o=s[1],l=Object(n.useCallback)((function(){return o(!1)}),[]),f=Object(n.useCallback)(K(d.Server,d.Minimax,a),[]),p=Object(n.useCallback)(K(d.Minimax,d.Server,a),[]);return function(e,t){Object(n.useEffect)((function(){var a=function(a){e.current&&!e.current.contains(a.target)&&t(a)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),function(){document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}}),[e,t])}(c,l),r.a.createElement("div",{className:"menu",ref:c},r.a.createElement("button",{className:"menu__toggler",onClick:function(){return o(!u)}},r.a.createElement("i",{className:"fas fa-bars"})),u&&r.a.createElement("div",{className:"menu__dropdown"},r.a.createElement("div",null,"Play against"),r.a.createElement(H,{checked:t===d.Server,label:d.Server,onChange:f}),r.a.createElement(H,{checked:t===d.Minimax,label:d.Minimax,onChange:p})))};var V=function(){var e=Object(n.useState)(w),t=Object(m.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(new G),s=Object(m.a)(i,2),f=s[0],v=s[1],h=Object(n.useState)({loading:!1,waiting:!0}),g=Object(m.a)(h,2),y=g[0],E=g[1];return r.a.createElement("div",{className:"App"},r.a.createElement(Q,{backend:f instanceof G?d.Server:d.Minimax,selectBackend:function(e){c(w),E({loading:!1,waiting:!0}),e===d.Server?v(new G):v(new q)}}),r.a.createElement(O,{play:function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E({waiting:!1,loading:!0}),e.next=3,f.createBoard(t);case 3:a=e.sent,c(Object(o.a)({},a,{turn:b.Player})),E({waiting:!1,loading:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),status:a.status}),r.a.createElement(k,{board:a.board,interaction:y,move:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.turn===b.Player&&a.status===p.InProgress){e.next=2;break}return e.abrupt("return");case 2:return E({waiting:!1,loading:!0}),c(Object(o.a)({},a,{turn:b.Ai})),e.next=6,f.takeTurn(a.id,t,n);case 6:r=e.sent,i=null,p.isFinished(r.status)&&(i=S(r.board)),c(Object(o.a)({},r,{result:i,turn:b.Player})),r.status===p.InProgress?E({waiting:!1,loading:!1}):E({waiting:!0,loading:!1});case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),result:a.result}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.b0837bd3.chunk.js.map